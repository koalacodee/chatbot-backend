model Ticket {
  id              String        @id @default(uuid()) @map("id") @db.Uuid
  guestId         String?       @map("guest_id") @db.Uuid
  guest           Guest?        @relation(fields: [guestId], references: [id], onDelete: Cascade)
  question        String        @map("question") @db.Text
  departmentId    String        @map("department_id") @db.Uuid
  department      Department    @relation(fields: [departmentId], references: [id], onDelete: Cascade)
  pointId         String?       @map("point_id") @db.Uuid
  ticketCode      String        @unique @map("ticket_code") @db.VarChar(255)
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")
  status          TicketStatus  @default(PENDING) @map("status")
  isAutoGenerated Boolean       @default(true) @map("is_auto_generated")
  answer          TicketAnswer?

  @@index([pointId, isAutoGenerated])
  @@index([departmentId])
  @@index([guestId])
  @@map("tickets")
}


model TicketAnswer {
  id        String   @id @default(uuid()) @map("id") @db.Uuid
  ticketId  String   @unique @map("ticket_id") @db.Uuid
  ticket    Ticket   @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  content   String   @map("content") @db.Text
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("ticket_answers")
}

enum TicketStatus {
  PENDING
  IN_PROGRESS
  CLOSED
}